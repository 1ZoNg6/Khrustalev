# üìä –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞

## üßÆ –§–æ—Ä–º—É–ª–∞ –∞–¥–¥–∏—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è

### **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:**
```
y_i = Œ£(S_j * W_j * (C_ij / Max_j))
```

**–ì–¥–µ:**
- `y_i` - –∏—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ i
- `S_j` - –∑–Ω–∞–∫ –∫—Ä–∏—Ç–µ—Ä–∏—è j (+1 –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, -1 –¥–ª—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö)
- `W_j` - –≤–µ—Å –∫—Ä–∏—Ç–µ—Ä–∏—è j
- `C_ij` - –∑–Ω–∞—á–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è j –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ i
- `Max_j` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è j

### **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏:**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ó–Ω–∞–∫ | –í–µ—Å | –ú–∞–∫—Å–∏–º—É–º | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|------|-----|----------|----------|
| –ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á | +1 | 1.0 | 5 | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π |
| –ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤ —Å—Ä–æ–∫ | -1 | 0.75 | 3 | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π |
| –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤ —Å—Ä–æ–∫ | +1 | 1.0 | 2 | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π |
| –°—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ | +1 | 1.0 | 650,000 | –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–æ–∑–¥–∞–Ω–∏–π | -1 | 0.5 | 2 | –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π |

## üìã –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞

### **–î–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã:**

| –°–æ—Ç—Ä—É–¥–Ω–∏–∫ | –ß–∞—Å—Ç–æ—Ç–∞ | –ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ | –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ | –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã (‚ÇΩ) | –û–ø–æ–∑–¥–∞–Ω–∏—è |
|-----------|---------|---------------|-------------|---------------|-----------|
| A | 4 | 1 | 2 | 450,000 | 0 |
| –ë | 3 | 2 | 1 | 300,000 | 1 |

### **–†–∞—Å—á–µ—Ç –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ A:**

1. **–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á:** `+1 * 1.0 * (4/5) = 0.8`
2. **–ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤ —Å—Ä–æ–∫:** `-1 * 0.75 * (1/3) = -0.25`
3. **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤ —Å—Ä–æ–∫:** `+1 * 1.0 * (2/2) = 1.0`
4. **–°—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤:** `+1 * 1.0 * (450000/650000) = 0.6923`
5. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–æ–∑–¥–∞–Ω–∏–π:** `-1 * 0.5 * (0/2) = 0`

**–ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª A:** `0.8 + (-0.25) + 1.0 + 0.6923 + 0 = 2.2423`

### **–†–∞—Å—á–µ—Ç –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ë:**

1. **–ß–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á:** `+1 * 1.0 * (3/5) = 0.6`
2. **–ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤ —Å—Ä–æ–∫:** `-1 * 0.75 * (2/3) = -0.5`
3. **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≤ —Å—Ä–æ–∫:** `+1 * 1.0 * (1/2) = 0.5`
4. **–°—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤:** `+1 * 1.0 * (300000/650000) = 0.4615`
5. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–æ–∑–¥–∞–Ω–∏–π:** `-1 * 0.5 * (1/2) = -0.25`

**–ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª –ë:** `0.6 + (-0.5) + 0.5 + 0.4615 + (-0.25) = 0.8115`

## üí∞ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–º–∏–∏

### **–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:**
```
–ü—Ä–µ–º–∏—è_i = (–ë–∞–ª–ª_i / Œ£(–ë–∞–ª–ª_j)) * –û–±—â–∏–π_—Ñ–æ–Ω–¥
```

### **–†–∞—Å—á–µ—Ç –¥–ª—è —Ñ–æ–Ω–¥–∞ 100,000 ‚ÇΩ:**

- **–û–±—â–∞—è —Å—É–º–º–∞ –±–∞–ª–ª–æ–≤:** `2.2423 + 0.8115 = 3.0538`
- **–î–æ–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ A:** `2.2423 / 3.0538 = 0.7344 (73.44%)`
- **–î–æ–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ë:** `0.8115 / 3.0538 = 0.2656 (26.56%)`

### **–ü—Ä–µ–º–∏–∏:**
- **–°–æ—Ç—Ä—É–¥–Ω–∏–∫ A:** `100,000 * 0.7344 = 73,440 ‚ÇΩ`
- **–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ë:** `100,000 * 0.2656 = 26,560 ‚ÇΩ`

## üîß SQL —Ñ—É–Ω–∫—Ü–∏–∏

### **–§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –±–∞–ª–ª–∞:**
```sql
SELECT calculate_employee_score(
    'user_id',
    '2024-01-01'::date,
    '2024-01-31'::date
);
```

### **–§—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–µ–º–∏–π:**
```sql
SELECT calculate_premium_distribution('fund_id');
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

1. **–°—É–º–º–∞ –ø—Ä–µ–º–∏–π ‚â§ –û–±—â–∏–π —Ñ–æ–Ω–¥**
2. **–í—Å–µ –±–∞–ª–ª—ã ‚â• 0** (–∏–ª–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏)
3. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –±–∞–ª–ª–∞–º**

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã

1. **–û–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - —á–µ—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏
2. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –ø–æ–Ω—è—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞
3. **–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å** - –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
4. **–ì–∏–±–∫–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ—Å–æ–≤ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —Ä–∞—Å—á–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## üìà –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞–∫–æ–≤ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö/–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–º–∏–π

